hooks:
  test:
    event: Stop
    command: "pytest"
    dirs_with:
      - "pyproject.toml"
    dir_test: "grep -qE '^pytest[^a-zA-Z]|\"pytest\"' pyproject.toml"
    if_changed:
      - "**/*.py"
      - "**/*.pyi"
      - "pyproject.toml"
      - "pytest.ini"
      - "conftest.py"

  test-changed:
    event: PostToolUse:Edit|Write
    command: "pytest ${HAN_FILES}"
    dirs_with:
      - "pyproject.toml"
    dir_test: "grep -qE '^pytest[^a-zA-Z]|\"pytest\"' pyproject.toml"
    if_changed:
      - "**/test_*.py"
      - "**/*_test.py"
      - "**/tests/*.py"
    file_test: grep -qE "(def test_|class Test)" "${HAN_FILE}"
