hooks:
  test:
    dirs_with:
      - "mix.exs"
    command: "mix test --stale"
    if_changed:
      - "**/*.ex"
      - "**/*.exs"
      - "**/*.eex"
      - "**/*.leex"
      - "**/*.heex"
      - "mix.exs"
      - "mix.lock"
  format:
    dirs_with:
      - ".formatter.exs"
    command: "mix format --check-formatted"
    if_changed:
      - "**/*.ex"
      - "**/*.exs"
      - "**/*.eex"
      - "**/*.leex"
      - "**/*.heex"
      - ".formatter.exs"
  build:
    dirs_with:
      - "mix.exs"
    command: "mix compile --warnings-as-errors"
    if_changed:
      - "**/*.ex"
      - "**/*.exs"
      - "**/*.eex"
      - "**/*.leex"
      - "**/*.heex"
      - "mix.exs"
      - "mix.lock"
  typecheck:
    dirs_with:
      - "mix.exs"
    command: "mix dialyzer"
    if_changed:
      - "**/*.ex"
      - "**/*.exs"
      - "**/*.eex"
      - "**/*.leex"
      - "**/*.heex"
      - "mix.exs"
      - "mix.lock"
  coverage:
    dirs_with:
      - "coveralls.json"
    # Only enforces coverage if minimum_coverage is set in coveralls.json
    command: "bash \"${CLAUDE_PLUGIN_ROOT}/scripts/coverage-ratchet.sh\""
    if_changed:
      - "**/*.ex"
      - "**/*.exs"
      - "mix.exs"
      - "mix.lock"
      - "coveralls.json"
