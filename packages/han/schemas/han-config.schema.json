{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "https://han.guru/schemas/han-config.schema.json",
	"title": "Han Plugin Configuration",
	"description": "Configuration schema for han-config.json files in Han plugins",
	"type": "object",
	"properties": {
		"hooks": {
			"type": "object",
			"description": "Hook definitions for the plugin",
			"additionalProperties": {
				"$ref": "#/definitions/hookDefinition"
			}
		}
	},
	"required": ["hooks"],
	"additionalProperties": false,
	"definitions": {
		"hookDefinition": {
			"type": "object",
			"description": "Definition for a single hook",
			"properties": {
				"command": {
					"type": "string",
					"description": "The command to execute for this hook"
				},
				"dirsWith": {
					"type": "array",
					"items": {
						"type": "string"
					},
					"description": "Glob patterns for marker files. The hook runs in directories containing these files."
				},
				"dirTest": {
					"type": "string",
					"description": "Shell command that must exit 0 for a directory to be included"
				},
				"ifChanged": {
					"type": "array",
					"items": {
						"type": "string"
					},
					"description": "Glob patterns relative to each target directory. When --cache is enabled, the hook will only run if files matching these patterns have changed."
				},
				"idleTimeout": {
					"type": "integer",
					"minimum": 0,
					"description": "Maximum time in seconds to wait for output before considering the hook as hanging. If no output is received within this period, the hook will be terminated and reported as failed."
				},
				"tip": {
					"type": "string",
					"description": "Guidance tip shown when this hook fails repeatedly. Should include the MCP tool name to use for this hook."
				}
			},
			"required": ["command"],
			"additionalProperties": false
		}
	}
}
